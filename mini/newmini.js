const menu=document.getElementById("menu"),pauseGame=()=>{say(""),pause=!0,games=[],menu.style.display="flex",workbook.innerHTML="",cont.classList.remove("end"),matrix.innerHTML="",timeouts.forEach(e=>clearTimeout(e))};let tutorial=!1;const clear=()=>{workbook.innerHTML="",matrix.innerHTML="",menu.style.display="none"},makeGames=()=>{if(clear(),pause=!1,games=[],tutorial){sfx([1.77,,202,.07,.14,.48,,.43,-4.8,,-5,.06,.16,,,,.14,.76]);for(let e=2;e<5;e++)for(let a=2;a<5;a++)addGame(~~e,~~a)}else addGame(1,2),tutorial=!0,timeout(()=>{for(let e=2;e<5;e++)for(let a=2;a<5;a++)addGame(~~e,~~a)},1e3);startNewGame()},startNewGame=()=>{if(clear(),game&&games.length<4){let e=9;const a=~~(4*Math.random()+3);addGame(a,e-a)}0!==games.length?(selectNewVoice(),game=games.shift(),sfx([,,-62,.02,.03,.23,,10.8,5.8,,200,-.07,,.3,2,,,1.3,.13,.3]),game.setupGame(),cont.classList.remove("end"),timeout(()=>{setupWorkbook(game)},500)):timeout(startNewGame,500)},addGame=(e=2,a=2)=>{let t,n,s,o,i,l,r,d,p,c,m,u;const h=()=>{t=[...Array(e)].map(e=>({})),n=[],s=0,o=[],i=[],l=!1,r=!1,d=[],p=0,c=!1,m=[],u=[]};h();const g=options.clueTypes;let $=options.cats,f=options.catNames,k=options.slotNames;k=sampleSize(e,k).map(e=>randSkinTone(e)).map(e=>randGender(e));const b=sampleSize(a,[...Array(f.length).keys()]);f=f.filter((e,a)=>-1!==b.indexOf(a)),$=$.filter((e,a)=>-1!==b.indexOf(a)).map(a=>sampleSize(e+2,a));const y=a*e,w=(e,a)=>{for(const t of Object.keys(a))if(e[t]&&e[t]!==a[t])return!1;return!0},x={*ti(e,a,t){for(const a of[...Array(t.length).keys()])yield*this.tiai(e,{index:a},t)},*tiai(e,a,t){if(w(t[a.index],e)){const n=JSON.parse(JSON.stringify(t));n[a.index]=Object.assign({},t[a.index],e),yield n}},*b(e,a,t){for(const n of[...Array(t.length-1).keys()])if(w(t[n],e)&&w(t[n+1],a)){const s=JSON.parse(JSON.stringify(t));s[n]=Object.assign({},t[n],e),s[n+1]=Object.assign({},t[n+1],a),yield s}},*a(e,a,t){for(const n of[...Array(t.length-1).keys()].map(e=>e+1))if(w(t[n],e)&&w(t[n-1],a)){const s=JSON.parse(JSON.stringify(t));s[n]=Object.assign({},t[n],e),s[n-1]=Object.assign({},t[n-1],a),yield s}},*nt(e,a,t){yield*this.a(e,a,t),yield*this.a(a,e,t)}},N=e=>{let a=!1;const t={};return e.reduce(function(e,n){for(var s in n)t[s]||(t[s]=[]),t[s].indexOf(n[s])>-1&&(a=!0),t[s].push(n[s]),e[s]=n[s];return e},{}),a};const v=()=>{const e=[];for(const a of function*e(a,t){if(0===(a=a.map(e=>"function"==typeof e?e:a=>x[e.type](e.data[0],e.data[1],a))).length){if(N(t))return void(yield!1);yield t}else{const[n,...s]=a;for(const a of n(t))yield*e(s,a)}}(n,t))e.push(a);return e.filter(e=>e)},L=(e=null,a,n)=>{if(a>100){const e=document.createElement("div");return e.classList.add("clue"),e.innerHTML=`<h3>${options[options.lang].noMore}</h3>`,sfx([4,,25,.01,.19,.61,1,2.68,.7,.5,,,.12,.9,,.4,.48,.52,.04,.33]),void workbook.appendChild(e)}let s,o,i,l;const r=(e="",a=1)=>{const t=sample(f.filter(a=>a!==e)),n=$[f.indexOf(t)];return{key:t,data:1===a?sample(n):sampleSize(a,n)}};switch(e||~~(Math.random()*g.length)){case 0:(o={})[(s=r()).key]=s.data,o[(s=r(s.key)).key]=s.data,l={type:g[0],data:[o,{data:[]}]};break;case 1:(o={})[(s=r()).key]=s.data,i={index:~~(Math.random()*t.length)},l={type:g[1],data:[o,i]};break;case 2:i={},(o={})[(s=r("",2)).key]=s.data[0],i[s.key]=s.data[1],l={type:g[2],data:[o,i]};break;case 3:i={},(o={})[(s=r("",2)).key]=s.data[0],i[s.key]=s.data[1],l={type:g[3],data:[i,o]};break;case 4:(o={})[(s=r()).key]=s.data,(i={})[(s=r(s.key)).key]=s.data,l={type:g[4],data:[o,i]}}d.some(e=>checkToString(e)===checkToString(l.data))?requestAnimationFrame(()=>{L(e,++a,n)}):(d.push(l.data),n(l))},M=(d=null,g=0)=>{L(d,g,d=>{n.push(d);let b=v();if(0==b||!b[0])return n.pop(),void M(null,++g);const w=b[0].reduce((e,a)=>e+Object.keys(a).length,0);if((b.reduce((e,a)=>e.concat(a),[]).some(e=>[Object,Array].includes((e||{}).constructor)&&!Object.entries(e||{}).length)||w===s)&&s<y)return n.length>8*t.length?(h(),void M()):(i.push(d),void requestAnimationFrame(()=>{M()}));if(s=w,!l)return i.push(d),(e=>{l||(l=!0,p=s,u.push({solution:e,selections:s}),o.push(i.slice(0)),i=[])})(b),void requestAnimationFrame(()=>{M()});if(l&&s<y)return i.push(d),s>Math.min(p+e,p+a)&&(e=>{r||(r=!0,u.push({solution:e,selections:s}),o.push(i.slice(0)),i=[])})(b),void requestAnimationFrame(()=>{M()});if(u.push({solution:b,selections:s}),c)return showClueArr([d]),void extraClueButton();i.push(d),o.push(i.slice(0)),c=!0,o.map(t=>(t=>{var n=[];let s;for(var o=0,i=t.length;o<i;o+=s)s=Math.max(1,~~(Math.random()*e+1),~~(Math.random()*a+1)),n.push(t.slice(o,o+s));return n})(t)).forEach((e,a)=>{e.forEach((t,n)=>{m.push({chore:"add chore",reward:n===e.length-1,boards:u[a].solution,rewardClues:t})})}),n.length<=3&&(m[m.length-1].rewardClues=m.map(e=>e.rewardClues).reduce((e,a)=>e.concat(a)),m=m.slice(m.length-1)),games.push({slotNum:e,catNum:a,levels:m,extraClue:M,clues:n,setupGame:()=>{createMatrix()},cats:$,catNames:f,slotNames:k,attempts:0}),games=games.sort((e,a)=>e.clues.length-a.clues.length)})};M(1)};let userBoard=[];const createMatrix=()=>{userBoard=[];for(let e=0;e<game.slotNum;e++)userBoard.push({});const e=document.createElement("table"),a=document.createElement("col");a.setAttribute("span",1),e.appendChild(a);let t=document.createElement("tr"),n=document.createElement("td");t.appendChild(n),game.slotNames.forEach(e=>{const a=document.createElement("th");a.classList.add("person"),a.innerHTML=`<span>${e}</span>`,t.appendChild(a)}),e.appendChild(t);game.cats.forEach((a,s)=>{(t=document.createElement("tr")).classList.add("mrow"),(n=document.createElement("th")).innerHTML=game.catNames[s],t.appendChild(n);const o=[options[options.lang].empty,...a];game.slotNames.forEach((e,a)=>{const n=document.createElement("td");n.classList.add("draggable");const i=document.createElement("span");i.setAttribute("data-option",0),i.innerText=o[0],userBoard[a][game.catNames[s]]={data:options[options.lang].empty,span:i},n.onclick=(e=>{((e,a,t,n)=>{let s=e.innerText;(s=a[a.indexOf(s)+1])||(s=a[0]),sfx([.7,.45,82.40689,,,.02,,3,35,,100*(a.indexOf(s)+1)-150,-.06,,,,,,.5,.03,.21]),userBoard[t][n]={data:s,span:e},e.innerText=s,e.classList.remove("correct","incorrect"),e.setAttribute("data-option",a.indexOf(s))})(i,o,a,game.catNames[s])}),n.appendChild(i),t.appendChild(n)}),e.appendChild(t),(t=document.createElement("tr")).classList.add("mrow")}),(t=document.createElement("tr")).classList.add("mrow");const s=document.createElement("td");s.innerHTML=`${options[options.lang].attempts}: <h2>0</h2>`,t.appendChild(s);const o=document.createElement("button");o.classList.add("clue"),o.onclick=(()=>{scoreMatrix()&&(o.parentNode.parentNode.parentNode.removeChild(o.parentNode.parentNode),workbook.innerHTML="",[...document.querySelectorAll("th.person")].forEach((e,a)=>e.classList.add("bigger")),workbook.scroll(0,0),cont.classList.add("end"),say(options[options.lang].wellDone),sfx(sounds.win),pause=!0,timeout(()=>{pause=!1,selectNewVoice(),startNewGame()},3e3)),s.innerHTML=`${options[options.lang].attempts}: <h2>${game.attempts}</h2>`}),o.innerText="üëç",(n=document.createElement("td")).setAttribute("colspan",game.slotNum),n.appendChild(o),t.appendChild(n),e.appendChild(t),matrix.appendChild(e)};let game,sound=!0,pause=!1,games=[];const shuffle=e=>e.sort(()=>.5-Math.random()),timeouts=[],cont=document.getElementById("cont"),workbook=document.getElementById("wb"),matrix=document.getElementById("matrix"),timeout=(e,a)=>{timeouts.push(setTimeout(e,a))},sounds={win:[1.4,,474,,.25,.63,1,1.145,-.3,,100,.09,.09,,,,.09,.4,.65]},options={lang:"en",clueTypes:["ti","tiai","a","b","nt"],cats:[["üëì","üëï","üëò","üé©","üë†","üß§","üß£","üëí","üß¢","üëü","ü©≥"],["üé∑","üé∏","üé∫","üéª","ü™ï","ü•Å","üéπ"],["‚öΩ","üèÄ","üèà","üéæ","ü•è","üèì","ü•ä","üé≥","üèê"],["‚ù§Ô∏è","üß°","üíõ","üíö","üíô","üíú","üñ§","ü§é","üíî"],["üçá","üçâ","üçä","üçé","ü•ù","ü••","üçê","üçë","üçí","üçã"],["üêí","üêï","ü¶ù","üêà","ü¶ì","üêÑ","üêñ","üê™","ü¶í","üêò","üêÅ","üêá","üêøÔ∏è","ü¶®","ü¶ò"],["ü•Ø","üçü","üçî","üçï","üßÄ","üçú","üç¶","üç©","üçø"],["üòç","üòé","üëø","ü§î","üòì","üò∑","ü•∫","üò°","ü§™","üòÄ"]],slotNames:["üßü‚Äç‚ôÇÔ∏è","ü¶πüèΩ‚Äç‚ôÇÔ∏è","ü¶∏üèΩ‚Äç‚ôÇÔ∏è","üßõüèΩ‚Äç‚ôÇÔ∏è","üë∑üèª‚Äç‚ôÇÔ∏è","üë®üèΩ‚Äçüé®","üë®üèø‚Äçüíº","üë®üèª‚Äçüîß","üë®üèæ‚Äç‚öïÔ∏è","üë®üèº‚Äçüåæ","üßëüèª‚Äç‚öñÔ∏è","üë®üèæ‚Äçüî¨","üë®üèº‚Äçüé§","üë®üèΩ‚ÄçüöÄ","üëÆüèΩ‚Äç‚ôÇÔ∏è","üë©üèΩ‚Äçüç≥","üßïüèº","üíÇüèΩ‚Äç‚ôÇÔ∏è","üßôüèº‚Äç‚ôÇÔ∏è","üë∞üèª","üë©üèº‚Äç‚úàÔ∏è","üßùüèΩ‚Äç‚ôÇÔ∏è","üë®üèæ‚Äçüöí","üë©üèΩ‚Äçüéì","üë©üèº‚Äçüè≠"],en:{attempts:"Attempts",wellDone:"Well Done!",solvable:"Solvable.",empty:"space",noMore:"No more clues.",tutorial:"Tutorial: Use the prompts. Fill in the spaces.  Then üëç"},tp:{attempts:"nanpa alasa",wellDone:"pona!",solvable:"ken li pini",empty:"ala",noMore:"pona ala",tutorial:"kama sona: sina kute e toki pi wile sona. tempo pini la sina luka e üëç"},fr:{attempts:"Essai #",wellDone:"Bien Jou√©!",solvable:"R√©solution Possible.",empty:"espace",noMore:"Indices termin√©s.",tutorial:"Tutoriel: Utilisez les indices et remplissez les espaces. Enfin appuyez sur üëç"},es:{attempts:"Prueba #",wellDone:"¬°Bien Hecho!",solvable:"Resoluci√≥n Posible.",empty:"espacio",noMore:"No m√°s pistas.",tutorial:"Tutorial: Usa las pistas y completa la informaci√≥n. Finalmente toca üëç"},"zh-CN":{attempts:"ÁåúÊµã ÔºÉ",wellDone:"ÂÅöÂæóÂ•Ω!",solvable:"ÂèØ‰ª•ÂÆåÊàê",empty:"Á©∫ÁôΩ",noMore:"Ê≤°Êúâ‰∫Ü",tutorial:"ÊïôÁ®ãÔºö‰ΩøÁî®Á∫øÁ¥¢Âπ∂ÂÆåÊàê‰ø°ÊÅØ„ÄÇ Áªà‰∫éÊë∏‰∫Üüëç"}},lang=(e,a=!0)=>{switch(pause=!1,a&&(sfx([.7,.45,82.40689,,,.02,,3,35,,-150,-.06,,,,,,.5,.03,.21]),e.target&&(e.target.classList.add("selected"),e=e?e.target.getAttribute("id"):"en")),options.lang=e,workbook.setAttribute("data-msg",options[options.lang].wellDone),options.lang){case"tp":options.catNames=["len","kalama musi","musi utala","olin","kili","soweli","moku","pilin"];break;case"fr":options.catNames=["le v√™tement","l'instrument","le sport","le c≈ìur","la fruit","l'animal","la bouffe","le sentiment"];break;case"es":options.catNames=["la ropa","el instrumento","la deporte","la coraz√≥n","la fruta","el animal","la comida","el sentimiento"];break;case"zh-CN":options.catNames=["Ë°£Êúç","‰ª™Âô®","ËøêÂä®","ÂøÉËÑè","Ê∞¥Êûú","Âä®Áâ©","È£üÁâ©","ÂøÉÊÉÖ"];break;default:options.catNames=["clothes","instrument","sport","heart","fruit","animal","food","mood"]}};lang("en",!1),[...document.getElementsByClassName("lang")].forEach((e,a,t)=>{e.addEventListener("click",e=>{t.forEach(e=>e.classList.remove("selected")),lang(e)})});const checkToString=e=>e.map(e=>Object.keys(e).concat(Object.values(e))).flat().sort().join(),randBetween=(e,a)=>~~(Math.random()*(a-e+1)+e),sample=e=>{const a=null==e?0:e.length;return a?e[Math.floor(Math.random()*a)]:void 0},sampleSize=(e,a,t=[])=>e<1||a.length<1?t:shuffle(e>=a.length?[...t,...a]:Math.random()<e/a.length?sampleSize(e-1,a.slice(1),[...t,a[0]]):sampleSize(e,a.slice(1),t)),stMod=["üèª","üèº","üèΩ","üèæ","üèø"],gMod=["üë©","üë®"],gMod2=["‚ôÇÔ∏è","‚ôÄÔ∏è"],findSkin=new RegExp("\ud83c[\udffb-\udfff]","g"),findGender=new RegExp(gMod.join("|"),"g"),findGender2=new RegExp(gMod2.join("|"),"g"),randSkinTone=e=>e.replace(findSkin,sample(stMod)),randGender=e=>e.replace(findGender,sample(gMod)).replace(findGender2,sample(gMod2));let voice;const selectNewVoice=()=>{(voice=(voice=window.speechSynthesis.getVoices().filter(e=>e.lang.indexOf(options.lang)>-1))[randBetween(0,voice.length)])||timeout(selectNewVoice,1e3)};selectNewVoice();const sfx=e=>{pause||sound&&zzfx(...e)};let say=e=>{if("tp"===options.lang)return;if(!sound)return;if(pause)return;selectNewVoice(),speechSynthesis.cancel();const a=new SpeechSynthesisUtterance;a.voice=voice,a.volume=3,a.rate=1,a.text=e.replace(new RegExp("c≈ìur|coraz√≥n|heart","g"),""),a.lang=options.lang,speechSynthesis.speak(a)};zzfxV=.3,zzfx=((e=1,a=.05,t=220,n=0,s=0,o=.1,i=0,l=1,r=0,d=0,p=0,c=0,m=0,u=0,h=0,g=0,$=0,f=1,k=0,b=0)=>{let y,w,x=Math,N=44100,v=2*x.PI,L=r*=500*v/N/N,M=t*=(1-a+2*a*x.random(a=[]))*v/N,T=0,C=0,E=0,O=1,z=0,S=0,A=0;for(d*=500*v/N**3,h*=v/N,p*=v/N,c*=N,m=N*m|0,w=(n=N*n+9)+(k*=N)+(s*=N)+(o*=N)+($*=N)|0;E<w;a[E++]=A)++S%(100*g|0)||(A=i?1<i?2<i?3<i?x.sin((T%v)**3):x.max(x.min(x.tan(T),1),-1):1-(2*T/v%2+2)%2:1-4*x.abs(x.round(T/v)-T/v):x.sin(T),A=(m?1-b+b*x.sin(v*E/m):1)*(0<A?1:-1)*x.abs(A)**l*e*zzfxV*(E<n?E/n:E<n+k?1-(E-n)/k*(1-f):E<n+k+s?f:E<w-$?(w-E-$)/o*f:0),A=$?A/2+($>E?0:(E<w-$?1:(w-E)/$)*a[E-$|0]/2):A),T+=(y=(t+=r+=d)*x.cos(h*C++))-y*u*(1-1e9*(x.sin(E)+1)%2),O&&++O>c&&(t+=p,M+=p,O=0),!m||++z%m||(t=M,r=L,O=O||1);return(e=zzfxX.createBuffer(1,w,N)).getChannelData(0).set(a),(t=zzfxX.createBufferSource()).buffer=e,t.connect(zzfxX.destination),t.start(),t}),zzfxX=new(window.AudioContext||webkitAudioContext);const wordClues=e=>{const a=Object.keys(e.data[0]),t=Object.keys(e.data[1]||{});let n,s,o;switch(n=game.cats[game.catNames.indexOf(a[0])].indexOf(e.data[0][a[0]])+1,s=(game.cats[game.catNames.indexOf(a[1])]||[]).indexOf(e.data[0][a[1]])+1,t.length&&(o=(game.cats[game.catNames.indexOf(t[0])]||[]).indexOf(e.data[1][t[0]])+1),options.lang){case"es":switch(e.type){case"ti":return`la persona con ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>, tambi√©n tiene ${a[1]}  <span data-option="${s}">${e.data[0][a[1]]}</span>`;case"tiai":return`<span class="person">${game.slotNames[e.data[1].index]}</span>tiene ${a[0]} <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"b":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> est√° a la derecha de ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"a":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> est√° a la izquierda de ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"nt":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> est√° cerca de ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`}break;case"fr":switch(e.type){case"ti":return`la personne avec ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>, aussi tiens ${a[1]}  <span data-option="${s}">${e.data[0][a[1]]}</span>`;case"tiai":return`<span class="person">${game.slotNames[e.data[1].index]}</span>tiens ${a[0]} <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"b":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> est √† droite de ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"a":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> est √† gauche de ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"nt":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> est a cot√© de ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`}break;case"zh-CN":switch(e.type){case"ti":return`Êúâ <span data-option="${n}">${e.data[0][a[0]]}</span> ${a[0]} ÁöÑ‰∫∫, ‰πüÊúâ <span data-option="${s}">${e.data[0][a[1]]}</span> ÁöÑ${a[1]}  `;case"tiai":return`<span class="person">${game.slotNames[e.data[1].index]}</span> Êúâ <span data-option="${n}">${e.data[0][a[0]]}</span> ÁöÑ${a[0]}`;case"b":return`${t[0]} <span data-option="${o}">${e.data[1][t[0]]}</span> Âú® ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span> ÁöÑÂè≥Ëæπ`;case"a":return`${t[0]} <span data-option="${o}">${e.data[1][t[0]]}</span> Âú® ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span> ÁöÑÂ∑¶Ëæπ`;case"nt":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> Â∞±Âú® ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span> ÁöÑÊóÅËæπ`}case"tp":switch(e.type){case"ti":return`jan li jo e ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>, taso jo e ${a[1]}  <span data-option="${s}">${e.data[0][a[1]]}</span>`;case"tiai":return`jan <span class="person">${game.slotNames[e.data[1].index]}</span>li jo e ${a[0]} <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"b":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> li lon poka pini e ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"a":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> li lon poka open e ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"nt":return`${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span> li lon poka e ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>`}break;default:switch(e.type){case"ti":return`The one with ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>, also has ${a[1]}  <span data-option="${s}">${e.data[0][a[1]]}</span>`;case"tiai":return`<span class="person">${game.slotNames[e.data[1].index]}</span>has ${a[0]} <span data-option="${n}">${e.data[0][a[0]]}</span>`;case"a":return`One left of ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>,\n        is ${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}`;case"b":return`One right of ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>, is ${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span>`;case"nt":return`Next to ${a[0]}  <span data-option="${n}">${e.data[0][a[0]]}</span>, is ${t[0]}  <span data-option="${o}">${e.data[1][t[0]]}</span>`}}},showClueArr=(e,a)=>{[...document.getElementsByClassName("loading")].forEach(e=>e.classList.remove("loading")),e.map(wordClues).forEach((e,a)=>{const t=document.createElement("div");t.classList.add("waiting"),t.innerHTML="<h1>‚úâÔ∏è</h1>",workbook.appendChild(t),timeout(()=>{t.classList.add("clue"),t.classList.remove("waiting"),t.onclick=(e=>{say(e.target.innerText.replace(findSkin,""))}),t.innerHTML=e,sfx([2,0,60,.01,,.26,1,2.5,.2,,,,1,,,,,.3,.05]),say(t.innerText.replace(findSkin,""))},clueTime*(a+(sound?0:1)))}),a&&timeout(()=>{const e=document.createElement("div");e.classList.add("clue"),e.innerHTML='<h3 class="loading">&nbsp;</h3>',workbook.appendChild(e)},1e3*(e.length+1))},scoreMatrix=()=>{game.attempts+=1;const e=game.levels[game.levels.length-1].boards[0];let a=!0;for(let t=0;t<game.slotNum;t++)for(let n=0;n<game.cats.length;n++){const s=userBoard[t][game.catNames[n]];s.span.classList.remove("correct,incorrect"),s.data!==options[options.lang].empty?e[t][game.catNames[n]]===s.data?timeout(()=>{s.span.classList.add("correct"),s.span.classList.remove("incorrect")},100*(n+t)):(timeout(()=>{s.span.classList.remove("correct"),s.span.classList.add("incorrect"),sfx([1.82,,1554,,.03,.23,,1.67,,,,,,,34,,.06,.62,.06])},100*(n+t)),a=!1):a=!1}return a},extraClueButton=()=>{const e=document.createElement("button");e.classList.add("clue"),e.onclick=(()=>{sfx([3,,22,,.14,.08,1,2.8,4,-.7,-300,,,1.9,,.5,.01,.75,.01]),e.parentNode.removeChild(e),game.extraClue()}),e.innerText="üì©";for(let e=0;e<3;e++){const e=document.createElement("br");workbook.appendChild(e)}workbook.appendChild(e)};let clueTime,levelTime;const setupWorkbook=()=>{clueTime=sound?6e3:800,levelTime=sound?2e3:7e3;const e=1===game.slotNum?6e3:0;let a=0;if(game.levels.forEach((t,n,s)=>{timeout(()=>{if(game.level=n,showClueArr(t.rewardClues,n<s.length-1),game.level===s.length-1){const e=document.createElement("div");e.classList.add("clue"),e.innerHTML='<h3 class="loading">&nbsp;</h3>',workbook.appendChild(e),timeout(()=>{e.classList.add("clue"),e.classList.remove("loading"),e.innerHTML=`<br/><br/><h3>${options[options.lang].solvable}</h3>`,say(options[options.lang].solvable),workbook.appendChild(e),extraClueButton()},clueTime*t.rewardClues.length-1)}},a*clueTime+e+n*levelTime),a+=t.rewardClues.length}),e>0){const e=document.createElement("div");e.innerHTML=`<div class="tutorial">${options[options.lang].tutorial}</div>`,say(options[options.lang].tutorial),workbook.appendChild(e)}};function scroller(e){switch(e.deltaMode){case 0:wb.scrollTop+=e.deltaY,wb.scrollLeft+=e.deltaX;break;case 1:wb.scrollTop+=15*e.deltaY,wb.scrollLeft+=15*e.deltaX;break;case 2:wb.scrollTop+=.03*e.deltaY,wb.scrollLeft+=.03*e.deltaX}e.stopPropagation()}document.onwheel=scroller;
