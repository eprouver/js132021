const ge="getElementById",cl="classList",ac="appendChild",ih="innerHTML",d=document,menu=d[ge]("menu"),M=Math,ra="random",raf=requestAnimationFrame,pauseGame=()=>{say(""),pause=!0,games=[],clear(),menu.style.display="flex",cont[cl].remove("end"),timeouts.forEach(e=>clearTimeout(e))};let tutorial=!1;const clear=()=>{wbc[ih]="",matrix[ih]="",menu.style.display="none"};let tt;const makeGames=()=>{clear(),pause=!1,games=[],tutorial?sng():(sng(tt),tutorial=!0,files=0),to(()=>{for(let e=2;e<5;e++)for(let t=2;t<5;t++)addGame(~~e,~~t).then(e=>games.push(e))},tutorial?0:1e3)};let files=0;const sng=e=>{if(pause=!1,games.length<2){const e=()=>2+~~(5*M[ra]());let t=e(),a=e();for(;t+a>9;)t=e(),a=e();addGame(t,a).then(e=>games.push(e))}if(curG=e||games.shift()){if(!e&&(files+=1)>opt.files)return showChoose(),void(files=0);wbc.setAttribute("data-msg",`${opt[opt.lang].wellDone}`),clear(),opt.t=!0,selectNewVoice(),sfx([,,-62,.02,.03,.23,,10.8,5.8,,200,-.07,,.3,2,,,1.3,.13,.3]),createMatrix(),cont[cl].remove("end"),to(()=>{setupWorkbook(curG)},500)}else to(sng,500)};function scroller(e){switch(e.deltaMode){case 0:wbc.scrollTop+=e.deltaY;break;case 1:wbc.scrollTop+=15*e.deltaY;break;case 2:wbc.scrollTop+=.03*e.deltaY}e.stopPropagation()}d.onwheel=scroller,d.monetization&&d.monetization.state&&(d[ge]("mon-files").style.display="inline-block",d[ge]("coil")[ih]="You're signed into COIL.");const showChoose=()=>{clear(),timeouts.forEach(e=>clearTimeout(e)),cont[cl].remove("end"),root.style.display="flex",say(opt[opt.lang].ff),fi("nc",opt[opt.lang].newCase),fi("cf",opt[opt.lang].ff),fi("ch",`${opt[opt.lang].ch} ${opt[opt.lang].newCase}`),fi("peplabel",opt[opt.lang].p),fi("catlabel",opt[opt.lang].c),fi("create",`${opt[opt.lang].cr} ${opt[opt.lang].newCase}`),fi("com",opt[opt.lang].com),fi("com2",opt[opt.lang].com)},ser=e=>{delete e.sNum,delete e.catNum,delete e.attempts;let t=JSON.stringify(e);return e.cNms.forEach((e,a)=>t=t.replace(new RegExp(e,"g"),`b${a}b`)),(t=JSON.parse(t)).cNms=e.cNms,JSON.stringify(t)},deser=e=>{return JSON.parse(e).cNms.forEach((t,a)=>e=e.replace(new RegExp(`b${a}b`,"g"),t)),(e=JSON.parse(e)).sNum=e.slotNames.length,e.catNum=e.cNms.length,e.attempts=0,e},config={nodeUrl:"https://rpc.testnet.near.org",deps:{keyStore:new nearApi.keyStores.BrowserLocalStorageKeyStore},networkId:"testnet"};let subGame;!async function(){const{connect:e,keyStores:t,WalletConnection:a}=nearApi,n={networkId:"testnet",keyStore:new t.BrowserLocalStorageKeyStore,nodeUrl:"https://rpc.testnet.near.org",walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};window.near=await e(n);const s=new a(near),o=await s.account(),r=d[ge]("near");s.isSignedIn()&&(r[ih]="You're signed into NEAR."),r.onclick=(()=>{1==confirm("Going to NEAR to log in.")&&s.requestSignIn("dev-1629217600951-74234604044359")});const c=new nearApi.Contract(o,"dev-1629217600951-74234604044359",{viewMethods:["getMessages"],changeMethods:["addMessage"],sender:o});messages=await c.getMessages(),subGame=(()=>{s.isSignedIn()?(clear(),wbc[ac](nnote()),root.style.display="none",addGame(5,5).then(e=>{c.addMessage({text:JSON.stringify(e),gas:1e14}),sng(e)})):1==confirm("Going to NEAR to log in.")&&s.requestSignIn("dev-1629217600951-74234604044359")});const i=d[ge]("com-list");sampleSize(20,messages.filter(e=>"{"===e.text[0])).forEach(e=>{const t=ce("div");t[ih]=`<div class="sub-game"><span>5x5</span> - ${e.sender}: <span>üëç</span></div>`,t.onclick=(()=>{clear(),root.style.display="none",sng(deser(e.text))}),i[ac](t)})}(window);const addGame=(e=2,t=2)=>new Promise(function(a){let n,s,o,r,c,i,l,p,d,u,m,f;const g=()=>{n=[...Array(e)].map(e=>({})),s=[],o=0,r=[],c=[],i=!1,l=!1,p=[],d=0,u=!1,m=[],f=[]};g();let h=opt.cats,$=opt.cNms,w=opt.slotNames;w=sampleSize(e,w).map(e=>randSkinTone(e)).map(e=>randGender(e));const b=sampleSize(t,[...Array($.length).keys()]);$=$.filter((e,t)=>-1!==b.indexOf(t)),h=h.filter((e,t)=>-1!==b.indexOf(t)).map(t=>sampleSize(e+2,t));const y=t*e,N=(e,t)=>{for(const a of Object.keys(t))if(e[a]&&e[a]!==t[a])return!1;return!0},k={*ti(e,t,a){for(const t of[...Array(a.length).keys()])yield*this.tiai(e,{i:t},a)},*tiai(e,t,a){if(N(a[t.i],e)){const n=JSON.parse(JSON.stringify(a));n[t.i]=Object.assign({},a[t.i],e),yield n}},*b(e,t,a){for(const n of[...Array(a.length-1).keys()])if(N(a[n],e)&&N(a[n+1],t)){const s=JSON.parse(JSON.stringify(a));s[n]=Object.assign({},a[n],e),s[n+1]=Object.assign({},a[n+1],t),yield s}},*a(e,t,a){for(const n of[...Array(a.length-1).keys()].map(e=>e+1))if(N(a[n],e)&&N(a[n-1],t)){const s=JSON.parse(JSON.stringify(a));s[n]=Object.assign({},a[n],e),s[n-1]=Object.assign({},a[n-1],t),yield s}},*nt(e,t,a){yield*this.a(e,t,a),yield*this.b(e,t,a)}},v=e=>{let t=!1;const a={};return e.reduce(function(e,n){for(var s in n)a[s]||(a[s]=[]),a[s].indexOf(n[s])>-1&&(t=!0),a[s].push(n[s]),e[s]=n[s];return e},{}),t};const x=e=>{const t=[];for(const a of function*e(t,a){if(0===(t=t.map(e=>"function"==typeof e?e:t=>k[e.type](e.d[0],e.d[1],t))).length){if(v(a))return void(yield!1);yield a}else{const[n,...s]=t;for(const t of n(a))yield*e(s,t)}}(e,n))t.push(a);return t.filter(e=>e)},G=(e=null,t,a)=>{if(t>100)return a(!1);let s,o,r={},c={};const i=(e="",t=1)=>{const a=sample($.filter(t=>t!==e)),n=h[$.indexOf(a)];return{key:a,d:1===t?sample(n):sampleSize(t,n)}};switch(e||sample([0,0,0,1,2,2,3,3,4,4])){case 0:r[(s=i()).key]=s.d,r[(s=i(s.key)).key]=s.d,o={type:opt.clueTypes[0],d:[r,{d:[]}]};break;case 1:r[(s=i()).key]=s.d,c={i:~~(M[ra]()*n.length)},o={type:opt.clueTypes[1],d:[r,c]};break;case 2:r[(s=i("",2)).key]=s.d[0],c[s.key]=s.d[1],o={type:opt.clueTypes[2],d:[r,c]};break;case 3:r[(s=i("",2)).key]=s.d[0],c[s.key]=s.d[1],o={type:opt.clueTypes[3],d:[c,r]};break;case 4:r[(s=i()).key]=s.d,c[(s=i(s.key)).key]=s.d,o={type:opt.clueTypes[4],d:[r,c]}}p.some(e=>checkToString(e)===checkToString(o.d))?raf(()=>G(e,++t,a)):(p.push(o.d),a(o))};let C=e<3;const S=(p=null,b=0,N=!1)=>{G(p,b,p=>{if(!p){if(N){const e=ce("div");e[cl].add("clue"),e[ih]=`<h3>${opt[opt.lang].noMore}</h3>`,wbc[ac](e)}return}s.push(p);let k=x(s);if(0==k||!k[0])return s.pop(),void S(null,++b,N);const v=k[0].reduce((e,t)=>e+Object.keys(t).length,0);if(c.push(p),(k.reduce((e,t)=>e.concat(t),[]).some(e=>[Object,Array].includes((e||{}).constructor)&&!Object.entries(e||{}).length)||v===o)&&o<y)return s.length>9*n.length?(g(),void S()):void raf(()=>S(null,0,N));if(o=v,!i)return(e=>{i||(i=!0,d=o,f.push({solution:e,selections:o}),r.push(c.slice(0)),c=[])})(k),void raf(()=>S(null,0,N));if(i&&o<y)return o>M.min(d+e,d+t)&&(e=>{l||(l=!0,f.push({solution:e,selections:o}),r.push(c.slice(0)),c=[])})(k),void raf(()=>S(null,0,N));{const n=x(s.map(e=>("nt"===e.type&&(e.d=e.d.reverse()),e)).reverse())[0];if(!n||!iareEquals(k[0],n))return void raf(()=>{S(1,0,N)});if(!C)return C=!0,void raf(()=>S(null,0,N));if(f.push({solution:k,selections:o}),u)return showClueArr([p]),void extraClueButton();r.push(c.slice(0)),u=!0,r.map(a=>(a=>{var n=[];let s;for(var o=0,r=a.length;o<r;o+=s)s=M.max(1,1+~~(M[ra]()*e),1+~~(M[ra]()*t)),n.push(a.slice(o,o+s));return n})(a)).forEach((e,t)=>{e.forEach((e,a)=>{m.push({cb:f[t].solution,rwc:e})})}),s.length<=3&&(m[m.length-1].rwc=m.map(e=>e.rwc).reduce((e,t)=>e.concat(t)),m=m.slice(m.length-1)),a({sNum:e,catNum:t,levels:m,extraClue:()=>{S(null,0,!0)},clues:s,cats:h,cNms:$,slotNames:w,attempts:0})}})};S(1)});let userBoard=[];const createMatrix=()=>{userBoard=[];for(let e=0;e<curG.sNum;e++)userBoard.push({});const e=ce("table"),t=ce("col");t.setAttribute("span",1),e[ac](t);let a=ce("tr"),n=ce("td");a[ac](n),curG.slotNames.forEach(e=>{const t=ce("th");t[cl].add("person"),t[ih]=`<span>${e}</span>`,a[ac](t)}),e[ac](a);curG.cats.forEach((t,s)=>{(a=ce("tr"))[cl].add("mrow"),(n=ce("th"))[ih]=curG.cNms[s],a[ac](n);const o=["_",...t];curG.slotNames.forEach((e,t)=>{const n=ce("td");n[cl].add("draggable");const r=ce("span");r.setAttribute("data-option",0),r[ih]=o[0],userBoard[t][curG.cNms[s]]={d:"_",span:r},n.onclick=(e=>{((e,t,a,n)=>{let s=e.innerText;(s=t[t.indexOf(s)+1])||(s=t[0]),sfx([.7,.45,82.40689,,,.02,,3,35,,100*(t.indexOf(s)+1)-150,-.06,,,,,,.5,.03,.21]),userBoard[a][n]={d:s,span:e},e.innerText=s,e[cl].remove("correct","incorrect"),e.setAttribute("data-option",t.indexOf(s))})(r,o,t,curG.cNms[s])}),n[ac](r),a[ac](n)}),e[ac](a),(a=ce("tr"))[cl].add("mrow")}),(a=ce("tr"))[cl].add("mrow"),a[ac](ce("td"));const s=ce("button");s[cl].add("clue"),s.onclick=(()=>{scoreMatrix()&&(s.parentNode.parentNode.parentNode.removeChild(s.parentNode.parentNode),wbc[ih]="",wbc.parentElement.scrollTo(0,0),cont[cl].add("end"),say(opt[opt.lang].wellDone+(opt.t?"... 100%":"")),sfx([1.4,,474,,.25,.63,1,1.145,-.3,,100,.09,.09,,,,.09,.4,.65]),pause=!0,to(()=>{pause=!1,wbc[ih]="",timeouts.forEach(e=>clearTimeout(e)),selectNewVoice(),sng()},3e3))}),s.innerText="üëç",(n=ce("td")).setAttribute("colspan",curG.sNum),n[ac](s),a[ac](n),e[ac](a),matrix[ac](e)};let curG,sound=!0,pause=!1,games=[];const shuffle=e=>e.sort(()=>.5-M[ra]()),timeouts=[],cont=d[ge]("cont"),wbc=d[ge]("wbc"),matrix=d[ge]("matrix"),root=d[ge]("root"),gi=(e,t=3)=>parseInt(d[ge](e).value)||t,fi=(e,t)=>d[ge](e).innerText=t,ce=e=>d.createElement(e),to=(e,t)=>{timeouts.push(setTimeout(e,t))},checkToString=e=>e.map(e=>Object.keys(e).concat(Object.values(e))).flat().sort().join(),sample=e=>{const t=null==e?0:e.length;return t?e[~~(M[ra]()*t)]:void 0},sampleSize=(e,t,a=[])=>e<1||t.length<1?a:shuffle(e>=t.length?[...a,...t]:M[ra]()<e/t.length?sampleSize(e-1,t.slice(1),[...a,t[0]]):sampleSize(e,t.slice(1),a)),iareEquals=(e,t)=>{for(let n=0;n<e.length;n++){for(var a in e[n])if(!(a in t[n])||e[n][a]!==t[n][a])return!1;for(var a in t[n])if(!(a in e[n])||e[n][a]!==t[n][a])return!1}return!0},stMod=["üèª","üèº","üèΩ","üèæ","üèø"],gMod=["üë©","üë®"],gMod2=["‚ôÇÔ∏è","‚ôÄÔ∏è"],findSkin=new RegExp("\ud83c[\udffb-\udfff]","g"),findGender=new RegExp(gMod.join("|"),"g"),findGender2=new RegExp(gMod2.join("|"),"g"),randSkinTone=e=>e.replace(findSkin,sample(stMod)),randGender=e=>e.replace(findGender,sample(gMod)).replace(findGender2,sample(gMod2));let det;const newDet=()=>{det=randSkinTone(randGender("üïµüèº‚Äç‚ôÇÔ∏è")),d[ge]("det").innerText=det,d.title=`BLANKS ${det} - Reduce the space`,wbc.setAttribute("data-flair",`${det}`)},opt={lang:"en",files:10,clueTypes:["ti","tiai","a","b","nt"],cats:[["üëì","üëï","üëò","üé©","üë†","üß§","üß£","üëí","üß¢","üëü","ü©≥"],["üé∑","üé∏","üé∫","üéª","ü™ï","ü•Å","üéπ"],["‚öΩ","üèÄ","üèà","üéæ","ü•è","üèì","ü•ä","üé≥","üèê","‚öæ","üè∏"],["‚ù§Ô∏è","üß°","üíõ","üíö","üíô","üíú","üñ§","ü§é","üíî"],["üçá","üçâ","üçä","üçé","ü•ù","ü••","üçê","üçë","üçí","üçã"],["üêí","üêï","ü¶ù","üêà","ü¶ì","üêÑ","üêñ","üê™","ü¶í","üêò","üêá","üêøÔ∏è","ü¶®"],["ü•Ø","üçî","üçï","üßÄ","üçú","üç¶","üç©","üçø","ü•ê","üåÆ","üç£"],["üòç","üòé","üëø","ü§î","üòì","üò∑","ü•∫","üò°","ü§™","üòá","ü•∂","ü•±"]],slotNames:["üßü‚Äç‚ôÇÔ∏è","ü¶πüèΩ‚Äç‚ôÇÔ∏è","ü¶∏üèΩ‚Äç‚ôÇÔ∏è","üßõüèΩ‚Äç‚ôÇÔ∏è","üë∑üèª‚Äç‚ôÇÔ∏è","üë®üèΩ‚Äçüé®","üë®üèø‚Äçüíº","üë®üèª‚Äçüîß","üë®üèæ‚Äç‚öïÔ∏è","üë®üèº‚Äçüåæ","üë®üèΩ‚Äç‚öñÔ∏è","üë®üèæ‚Äçüî¨","üë®üèº‚Äçüé§","üë®üèΩ‚ÄçüöÄ","üëÆüèΩ‚Äç‚ôÇÔ∏è","üë©üèΩ‚Äçüç≥","üßïüèº","üíÇüèΩ‚Äç‚ôÇÔ∏è","üßôüèº‚Äç‚ôÇÔ∏è","üë∞üèª","üë©üèº‚Äç‚úàÔ∏è","üßùüèΩ‚Äç‚ôÇÔ∏è","üë®üèæ‚Äçüöí","üë©üèΩ‚Äçüéì","üë©üèº‚Äçüè≠"],en:{wellDone:"Well Done!",solvable:"Possible üëç",noMore:"No more clues.",tutorial:"Tutorial: Use the prompts. Fill in the spaces.  Then üëç",newCase:"New Case!",p:"# of People",c:"# of Categories",ch:"Choose",cr:"Create",com:"Community",ff:"Case Files"},tp:{wellDone:"pona!",solvable:"ken üëç",noMore:"pini",tutorial:"kama sona: o kute e toki pi wile sona. tenpo pini la o luka e üëç",newCase:"utala sin",p:"jan",c:"kulupu ilo",ch:"o pana",cr:"o sin",com:"kulupu",ff:"utala mute"},fr:{wellDone:"Bien Jou√©!",solvable:"üëç Possible",noMore:"Indices termin√©s.",tutorial:"Tutoriel: Utilisez les indices. Remplissez les espaces. Enfin appuyez sur üëç",newCase:"Nouveau Myst√®re!",p:"Nombre de Personnes",c:"Nombre de Cat√©gories",ch:"Choisir",cr:"Cr√©er",com:"Communaut√©",ff:"Fichiers de Myst√®res"},es:{wellDone:"¬°Bien Hecho!",solvable:"üëç Posible",noMore:"No m√°s pistas.",tutorial:"Tutorial: Usa las pistas. Completa la informaci√≥n. Finalmente toca üëç",newCase:"Nuevo Misterio!",p:"Gente",c:"Categor√≠as",ch:"Elegir",cr:"Crear",com:"Comunidad",ff:"Archivos de Misterios"},"zh-CN":{wellDone:"ÂÅöÂæóÂ•Ω!",solvable:"ÂèØ‰ª•ÂÆåÊàê",noMore:"Ê≤°Êúâ‰∫Ü",tutorial:"ÊïôÁ®ãÔºö‰ΩøÁî®Á∫øÁ¥¢Âπ∂ÂÆåÊàê‰ø°ÊÅØ„ÄÇ ÁÑ∂ÂêéÂçïÂáª üëç„ÄÇ",newCase:"Êñ∞Ë∞úÂ∫ï!",p:"‰∫∫Êï∞",c:"Á±ªÂà´Êï∞",ch:"ÈÄâÊã©",cr:"ÂàõÂª∫",com:"Á§æÂå∫",ff:"Á•ûÁßòÊ°£Ê°à"}},lang=(e,t=!0)=>{switch(pause=!1,t&&(sfx([.7,.45,82.40689,,,.02,,3,35,,-150,-.06,,,,,,.5,.03,.21]),e.target&&(e.target[cl].add("selected"),e=e?e.target.getAttribute("id"):"en")),opt.lang=e,opt.lang){case"tp":opt.cNms=["len","kalama musi","musi utala","olin","kili","soweli","moku","pilin"];break;case"fr":opt.cNms=["le v√™tement","l'instrument","le sport","le c≈ìur","le fruit","l'animal","la bouffe","le sentiment"];break;case"es":opt.cNms=["la ropa","el instrumento","el deporte","el coraz√≥n","la fruta","el animal","la comida","el sentimiento"];break;case"zh-CN":opt.cNms=["Ë°£Êúç","‰πêÂô®","ËøêÂä®","ÂøÉËÑè","Ê∞¥Êûú","Âä®Áâ©","È£üÁâ©","ÂøÉÊÉÖ"];break;default:opt.cNms=["clothes","instrument","sport","heart","fruit","animal","food","mood"]}games=[],addGame(1,2).then(e=>tt=e)};let voice;lang("en",!1),[...d.getElementsByClassName("lang")].forEach((e,t,a)=>{e.addEventListener("click",e=>{a.forEach(e=>e[cl].remove("selected")),lang(e)})}),newDet();const selectNewVoice=()=>{(voice=(voice=window.speechSynthesis.getVoices().filter(e=>e.lang.indexOf(opt.lang)>-1))[new Date%voice.length])||to(selectNewVoice,1e3)};selectNewVoice();const sfx=e=>{pause||sound&&zzfx(...e)};let say=e=>{if("tp"===opt.lang)return;if(!sound)return;if(pause)return;selectNewVoice(),speechSynthesis.cancel();const t=new SpeechSynthesisUtterance;t.voice=voice,t.text=e.replace(new RegExp("c≈ìur|coraz√≥n|heart","g"),""),t.lang=opt.lang,speechSynthesis.speak(t)};const chooseGame=()=>{clear(),wbc[ac](nnote()),root.style.display="none",addGame(gi("people"),gi("cats")).then(e=>sng(e))};zzfxV=.3,zzfx=((e=1,t=.05,a=220,n=0,s=0,o=.1,r=0,c=1,i=0,l=0,p=0,d=0,u=0,m=0,f=0,g=0,h=0,$=1,w=0,b=0)=>{let y,N,k=44100,v=2*M.PI,x=i*=500*v/k/k,G=a*=(1-t+2*t*M[ra](t=[]))*v/k,C=0,S=0,T=0,O=1,E=0,z=0,A=0;for(l*=500*v/k**3,f*=v/k,p*=v/k,d*=k,u=k*u|0,N=(n=k*n+9)+(w*=k)+(s*=k)+(o*=k)+(h*=k)|0;T<N;t[T++]=A)++z%(100*g|0)||(A=r?1<r?2<r?3<r?M.sin((C%v)**3):M.max(M.min(M.tan(C),1),-1):1-(2*C/v%2+2)%2:1-4*M.abs(M.round(C/v)-C/v):M.sin(C),A=(u?1-b+b*M.sin(v*T/u):1)*(0<A?1:-1)*M.abs(A)**c*e*zzfxV*(T<n?T/n:T<n+w?1-(T-n)/w*(1-$):T<n+w+s?$:T<N-h?(N-T-h)/o*$:0),A=h?A/2+(h>T?0:(T<N-h?1:(N-T)/h)*t[T-h|0]/2):A),C+=(y=(a+=i+=l)*M.cos(f*S++))-y*m*(1-1e9*(M.sin(T)+1)%2),O&&++O>d&&(a+=p,G+=p,O=0),!u||++E%u||(a=G,i=x,O=O||1);return(e=zzfxX.createBuffer(1,N,k)).getChannelData(0).set(t),(a=zzfxX.createBufferSource()).buffer=e,a.connect(zzfxX.destination),a.start(),a}),zzfxX=new(window.AudioContext||webkitAudioContext);const wordClues=e=>{const t=Object.keys(e.d[0]),a=Object.keys(e.d[1]||{});let n,s,o;n=(curG.cats[curG.cNms.indexOf(t[0])]||[]).indexOf(e.d[0][t[0]])+1,s=(curG.cats[curG.cNms.indexOf(t[1])]||[]).indexOf(e.d[0][t[1]])+1,a.length&&(o=(curG.cats[curG.cNms.indexOf(a[0])]||[]).indexOf(e.d[1][a[0]])+1);let r="";switch(opt.lang){case"es":switch(r="la persona con",e.type){case"ti":return`${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>, tambi√©n tiene ${t[1]}  <span data-option="${s}">${e.d[0][t[1]]}</span>`;case"tiai":return`<span class="person">${curG.slotNames[e.d[1].i]}</span>tiene ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"b":return`${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> est√° a la derecha de ${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"a":return`${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> est√° a la izquierda de ${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"nt":return`${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> est√° cerca de ${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`}break;case"fr":switch(r="la personne avec",e.type){case"ti":return`${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>, aussi tiens ${t[1]}  <span data-option="${s}">${e.d[0][t[1]]}</span>`;case"tiai":return`<span class="person">${curG.slotNames[e.d[1].i]}</span>tiens ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"b":return`${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> est √† droite de<br/>${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"a":return`${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> est √† gauche de<br/>${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"nt":return`${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> est a cot√© de<br/>${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`}break;case"zh-CN":switch(e.type){case"ti":return`Êúâ <span data-option="${n}">${e.d[0][t[0]]}</span> ${t[0]} ÁöÑ‰∫∫, ‰πüÊúâ <span data-option="${s}">${e.d[0][t[1]]}</span> ÁöÑ${t[1]}`;case"tiai":return`<span class="person">${curG.slotNames[e.d[1].i]}</span> Êúâ <span data-option="${n}">${e.d[0][t[0]]}</span> ÁöÑ${t[0]}`;case"b":return`${a[0]} <span data-option="${o}">${e.d[1][a[0]]}</span> Âú® ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span> ÁöÑÂè≥Ëæπ`;case"a":return`${a[0]} <span data-option="${o}">${e.d[1][a[0]]}</span> Âú® ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span> ÁöÑÂ∑¶Ëæπ`;case"nt":return`${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> Â∞±Âú® ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span> ÁöÑÊóÅËæπ`}case"tp":switch(e.type){case"ti":return`jan li jo e ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span> li jo e ${t[1]}  <span data-option="${s}">${e.d[0][t[1]]}</span> kin`;case"tiai":return`jan <span class="person">${curG.slotNames[e.d[1].i]}</span>li jo e ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"b":return`${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> li lon poka pini pi ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"a":return`${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> li lon poka open pi ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"nt":return`${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span> li lon poka pi ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`}break;default:switch(r="the person with",e.type){case"ti":return`The one with ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>, also has ${t[1]}  <span data-option="${s}">${e.d[0][t[1]]}</span>`;case"tiai":return`<span class="person">${curG.slotNames[e.d[1].i]}</span>has ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>`;case"a":return`One left of ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span> is ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span>`;case"b":return`One right of ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span> is ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span>`;case"nt":return`Next to ${r} ${t[0]}  <span data-option="${n}">${e.d[0][t[0]]}</span>,<br/> is ${r} ${a[0]}  <span data-option="${o}">${e.d[1][a[0]]}</span>`}}},showClueArr=(e,t)=>{[...d.getElementsByClassName("loading")].forEach(e=>e[cl].remove("loading")),e.map(wordClues).forEach((e,t)=>{const a=ce("div");a[cl].add("waiting"),a[ih]="<div>üîç</div>",wbc[ac](a),to(()=>{a[cl].remove("waiting"),a[ih]="",to(()=>{a.onclick=(e=>{say(e.target.innerText.replace(findSkin,""))}),a[ih]=e,a[cl].add("clue"),sfx([2,0,60,.01,,.26,1,2.5,.2,,,,1,,,,,.3,.05]),say(a.innerText.replace(findSkin,""))},100)},clueTime*(t+(sound?0:1)))}),t&&to(()=>{const e=nnote();wbc[ac](e)},1e3*(e.length+1))},scoreMatrix=()=>{curG.attempts+=1;const e=curG.levels[curG.levels.length-1].cb[0];let t=!0;for(let a=0;a<curG.sNum;a++)for(let n=0;n<curG.cats.length;n++){const s=userBoard[a][curG.cNms[n]];s.span[cl].remove("correct,incorrect"),"_"!==s.d?e[a][curG.cNms[n]]===s.d?to(()=>{s.span.parentElement.style.pointerEvents="none",s.span[cl].add("correct"),s.span[cl].remove("incorrect")},100*(n+a)):(to(()=>{s.span[cl].add("incorrect"),sfx([1.82,,1554,,.03,.23,,1.67,,,,,,,34,,.06,.62,.06])},100*(n+a)),t=opt.t=!1):t=opt.t=!1}return t},extraClueButton=()=>{if(!curG.extraClue)return;const e=ce("button");e[cl].add("clue"),e.onclick=(()=>{e.parentNode.removeChild(e),curG.extraClue()}),e.innerText="+ üîç";const t=ce("div");t[cl].add("spacer"),wbc[ac](t),wbc[ac](e)},nnote=()=>{const e=ce("div");return e[cl].add("clue"),e[ih]='<h3 class="loading">&nbsp;</h3>',e};let clueTime,levelTime;const setupWorkbook=()=>{timeouts.forEach(e=>clearTimeout(e)),clueTime=sound?6600:800,levelTime=sound?2e3:7e3;const e=1===curG.sNum?sound?7e3:4e3:sound?2500:1e3;let t=0;curG.levels.forEach((a,n,s)=>{to(()=>{if(curG.level=n,showClueArr(a.rwc,n<s.length-1),curG.level===s.length-1){const e=nnote();wbc[ac](e),to(()=>{e[cl].add("clue"),e[cl].remove("loading"),e[ih]=`<br/><h3>${opt[opt.lang].solvable}</h3>`,opt.t=!1,say(opt[opt.lang].solvable),wbc[ac](e),extraClueButton()},clueTime*a.rwc.length-1+2e3)}},t*clueTime+e+n*levelTime),t+=a.rwc.length});const a=ce("div");1===curG.sNum?(a[ih]=`<div class="tutorial">${opt[opt.lang].tutorial}</div>`,say(opt[opt.lang].tutorial)):(newDet(),a[ih]=`<h1><span>${det}</span> ${opt[opt.lang].newCase}</h1>`,say(opt[opt.lang].newCase)),wbc[ac](a),wbc[ac](nnote())};
